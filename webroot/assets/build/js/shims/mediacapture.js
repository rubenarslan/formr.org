webshim.register("mediacapture",(function(e,t,a,i,r,n){"use strict";var s=-1,o=e.noop,c='input[type="file"].ws-filereader, input[type="file"].ws-capture',p=e.Deferred();!function(){var a=!(!navigator.getUserMedia||navigator.wsGetUserMedia),i=swfmini.hasFlashPlayerVersion("11.3"),r=function(){try{sessionStorage.setItem("wsCameras",JSON.stringify(s))}catch(e){}},n=function(){s=0,r(),p.reject(s)},c=function(){r(),p.resolve(s)};try{null==JSON.parse(sessionStorage.getItem("wsCameras"))&&(s=-1)}catch(e){}0===s||-1==s&&!a&&!i?n():i?o=function(){var a=t.cfg.mediaelement,i=a.playerPath||t.cfg.basePath+"swf/"+(a.playerName||"JarisFLVPlayer.swf"),r="wscameralistdetection",p={controltype:"1",jsapi:"1",source:"",id:r,evtId:r},d={id:r,name:r},l=e('<div><div id="'+r+'"></div></div>').css({position:"absolute",left:-999,width:5,height:5,overflow:"hidden"}).appendTo("body");t.mediaelement.jarisEvent=t.mediaelement.jarisEvent||{},t.mediaelement.jarisEvent[r]=function(e){s=e.cameras,l.remove(),s?c():n()},o=e.noop,swfmini.embedSWF(i,r,"100%","100%","11.3",!1,p,{allowscriptaccess:"always",allowNetworking:"all"},d)}:(s=-1,c())}();var d=/image\/\*|image\/jp/i,l=function(){t.ready("WINDOWLOAD",(function(){t.loader.loadList(["mediacapture-picker"])})),l=e.noop},u=function(){if(e(this).is("[capture].ws-filereader, .ws-capture")&&t.implement(this,"capture")){var a,i,r,n=e(this),s=n.prop("accept")||"image/*";if(!d.test(s))return;i=e('<button type="button" class="ws-capture-button" />'),(r=t.objectCreate(t.wsPopover,{},e.extend({prepareFor:i}))).element.addClass("capture-popover input-picker"),n.is(".ws-custom-file > *")?(a=n.closest(".ws-custom-file"),e('<div class="ws-capture-file" />').insertAfter(a).append(i).append(a)):n.before(i),r.element.insertAfter(i),i.on("click",(function(){t.mediacapture.showContent(n,i,r),r.show()})),l()}},f=function(){var e=this;o(),p.done((function(){u.call(e)}))};t.mediacapture={showContent:function(e,a,i){t.loader.loadList(["mediacapture-picker"]),t.ready("mediacapture-picker",(function(){t.mediacapture.showContent(e,a,i)}))}},t.defineNodeNamesBooleanProperty("input","capture"),s&&(p.done((function(){f=u,t.loader.addModule("mediacapture-picker",{noAutoCallback:!0,css:"styles/forms-picker.css",options:n})})),t.addReady((function(t,a){e(c,t).add(a.filter(c)).filter('[accept*="image"], :not([accept]), [accept=""]').each(f)})),t.ready("WINDOWLOAD",o)),"complete"==i.readyState&&t.isReady("WINDOWLOAD",!0)}));