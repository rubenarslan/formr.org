webshims.register("form-validation",(function(e,t,i,s,r,o){"use strict";function n(e){return e.name}function a(){if(!e.data(this,"wsCustomFile")){var t=Array.prototype.map,i=e(this),s=e('input[type="file"]',i),r=e(".ws-file-value",i),o=e.trim(r.html())||"&#160;",a=function(){var e=s.prop("files")||[],i=t.call(e,n).join(", ")||s.val();i?r.text(i):r.html(o)};e.data(this,"wsCustomFile",{showSelected:a}),e("button:not(.ws-capture-button)",i).attr("tabindex","-1"),s.on("change.webshim",a).each(a).jProp("form").on("reset",(function(){setTimeout(a)})),f&&e('<div class="ws-coverfile" />').insertAfter(s).on("click.webshim",(function(e){e.stopImmediatePropagation(),s.trigger("click")}))}}var l="webkitURL"in i,d=t.support,c=d.formvalidation&&!t.bugs.bustedValidity,p=l&&c,h=navigator.userAgent,f=-1!=h.indexOf("MSIE"),u=p&&parseFloat((h.match(/Safari\/([\d\.]+)/)||["","999999"])[1],10),m=o.iVal,v=m.errorClass||(m.errorClass="user-error"),g=m.successClass||(m.successClass="user-success"),y="."+g+", ."+v,w=m.errorWrapperClass||(m.errorWrapperClass="ws-invalid"),b=m.successWrapperClass||(m.successWrapperClass="ws-success"),C=m.errorBoxClass||(m.errorBoxClass="ws-errorbox"),x=m.errorMessageClass||(m.errorMessageClass="ws-errormessage"),E=m.errorBoxWrapper||(m.errorBoxWrapper="div"),k=m.errorMessageWrapper||(m.errorMessageWrapper="p"),T={checkbox:1,radio:1},M=t.loader,W=M.addModule,A=e([]),S=function(){return!e.prop(this,"form")},I=t.modules,F=I["form-core"].getGroupElements||function(t){t=e(t);var i,r,o=A;return"radio"==t[0].type&&(r=t.prop("form"),o=(o=(i=t[0].name)?r?e(r).jProp(i):e(s.getElementsByName(i)).filter(S):t).filter('[type="radio"]')),o},D=function(e){var t;try{t=s.activeElement.name===e}catch(e){}return t},O={radio:1,checkbox:1,"select-one":1,"select-multiple":1,file:1,date:1,month:1,week:1,text:1,password:1,search:1,email:1,tel:1,url:1},B={time:1,date:1,month:1,datetime:1,week:1,"datetime-local":1},P={refreshvalidityui:1,updatevalidation:1},R="."+m.errorClass+", ."+m.successClass,V=function(i){var s,r,o,n;if(m.sel&&i.target&&(s=e(i.target).getNativeElement()[0],o=e(s).getShadowElement(),"submit"!=s.type&&e.prop(s,"willValidate")&&("change"!=i.type||!(n=o.prop("type"))||O[n]))){r=e.data(s,"webshimsswitchvalidityclass");var a=function(){if(n||(n=o.prop("type")),!(p&&("change"==i.type||537.36>u)&&B[n]&&e.find.matchesSelector(i.target,":focus")||"focusout"==i.type&&"radio"==s.type&&D(s.name))){if("async"==t.refreshCustomValidityRules(s))return void e(s).one("updatevalidation.webshims",V);var r,a,l,d,c,h=e.prop(s,"validity");h.valid?o.hasClass(g)||(r=g,a=v,d="changedvaliditystate",l="changedvalid",T[s.type]&&s.checked&&F(s).not(s).removeClass(a).addClass(r).removeAttr("aria-invalid"),o.removeAttr("aria-invalid"),e.removeData(s,"webshimsinvalidcause")):(c=function(t,i){var s;return e.each(t,(function(t,r){return r?(s=t+e.prop(i,"validationMessage"),!1):void 0})),s}(h,s),e.data(s,"webshimsinvalidcause")!=c&&(e.data(s,"webshimsinvalidcause",c),d="changedvaliditystate"),o.hasClass(v)||(r=v,a=g,T[s.type]&&!s.checked&&F(s).not(s).removeClass(a).addClass(r).attr("aria-invalid","true"),o.attr("aria-invalid","true"),l="changedinvalid")),r&&(o.addClass(r).removeClass(a),setTimeout((function(){e(s).trigger(l)}))),d&&setTimeout((function(){e(s).trigger(d)})),e.removeData(s,"webshimsswitchvalidityclass")}};!1!==o.triggerHandler("wsallowinstantvalidation",[i])&&(r&&clearTimeout(r),P[i.type]?("refreshvalidityui"==i.type&&t.error("refreshvalidityui was renamed to updatevalidation"),a()):e.data(s,"webshimsswitchvalidityclass",setTimeout(a)))}},j=function(){t.errorbox.reset(this)};"validityUIEvents"in o&&(t.error("validityUIEvents was renamed to iVal.events"),m.events=o.validityUIEvents),m.events="events"in m?m.events||"":"focusout change",m.events&&(m.events+=" "),m.fieldWrapper||(m.fieldWrapper=":not(span):not(label):not(em):not(strong):not(p):not(.ws-custom-file)"),I["form-core"].getGroupElements||(I["form-core"].getGroupElements=F),e(s.body||"html").on(m.events+"refreshvalidityui updatevalidation.webshims invalid",V).on("refreshvalidationui.webshims",(function(t){e(t.target).getShadowElement().is(y)&&V({type:"updatevalidation",target:t.target})})).on("reset resetvalidation.webshims resetvalui",(function(i){var s,r=e(i.target);"resetvalui"==i.type&&t.error("resetvalui was renamed to resetvalidation"),r.is("form, fieldset")&&("form"==r[0].nodeName.toLowerCase()&&(s=!r.is(m.sel)),r=r.jProp("elements")),r=r.filter(R).removeAttr("aria-invalid").removeClass(m.errorClass+" "+m.successClass).getNativeElement().each((function(){e.removeData(this,"webshimsinvalidcause")})),s||(!1===s?r.each(j):r.trigger("resetvalidityui.webshims"))}));var N=function(){t.scrollRoot=e(s.scrollingElement?s.scrollingElement:l||"BackCompat"==s.compatMode?s.body:s.documentElement)},L="transitionDelay"in s.documentElement.style,U={display:"inline-block",left:0,top:0,marginTop:0,marginLeft:0,marginRight:0,marginBottom:0},z={slide:{show:"slideDown",hide:"slideUp"},fade:{show:"fadeIn",hide:"fadeOut"},no:{show:"show",hide:"hide"}};N(),t.ready("DOM",N);var _=/right|left/g,q=function(e){return"left"==e?"right":"left"};t.getRelOffset=function(t,i,s){var r,o;return t=e(t),e.swap(t[0],U,(function(){var n;e.position&&s&&e.position.getScrollInfo?(s.of||(s.of=i),n="rtl"==e(s.of).css("direction"),s.isRtl||(s.isRtl=!1),s.isRtl!=n&&(s.my=(s.my||"center").replace(_,q),s.at=(s.at||"center").replace(_,q),s.isRtl=n),t[s.isRtl?"addClass":"removeClass"]("ws-is-rtl"),s.using=function(e,i){t.attr({"data-horizontal":i.horizontal,"data-vertical":i.vertical}),r=e},t.attr({"data-horizontal":"","data-vertical":"","data-my":s.my,"data-at":s.at}),t.position(s)):(r=e(i).offset(),o=t.offset(),r.top-=o.top,r.left-=o.left,r.top+=i.outerHeight())})),r},e.extend(t.wsPopover,{isInElement:function(t,i){e.isArray(t)||(t=[t]);var s,r,o,n=!1;for(s=0,r=t.length;r>s;s++)if((o=t[s])&&o.jquery&&(o=o[0]),o&&(o==i||e.contains(o,i))){n=!0;break}return n},show:function(r){var o;if(!this.isVisible){var n=e.Event("wspopoverbeforeshow");if(this.element.trigger(n),!n.isDefaultPrevented()){this.isVisible=!0,!this._shadowAdded&&t.shadowClass&&(this.element.addClass(t.shadowClass),this._shadowAdded=!0),r=e(r||this.options.prepareFor).getNativeElement();var a=this,l=function(e){!a.options.hideOnBlur||a.stopBlur||a.isInElement([a.lastElement[0],r[0],a.element[0]],e.target)||a.hide()},d=e(r).getShadowElement(),c=function(e){clearTimeout(a.timers.repos),a.timers.repos=setTimeout((function(){a.position(d)}),e&&"pospopover"==e.type?4:200)};this.clear(),this.element.css("display","none"),this.prepareFor(r,d),this.position(d),this.options.inline?(o=(z[this.options.inline]||z.slide).show,a.element[o]().trigger("wspopovershow")):(this.element.removeClass("ws-po-visible"),a.timers.show=setTimeout((function(){a.element.css("display",""),a.timers.show=setTimeout((function(){a.element.addClass("ws-po-visible").trigger("wspopovershow")}),14)}),4)),e(s.body).on("focusin"+this.eventns+" mousedown"+this.eventns,l).children(":not(script), :not(iframe), :not(noscript)").on("mousedown"+this.eventns,l),this.element.off("pospopover").on("pospopover",c),e(i).on("resize"+this.eventns+" pospopover"+this.eventns,c)}}},_getAutoAppendElement:function(){var t=/^(?:span|i|label|b|p|tr|thead|tbody|table|strong|em|ul|ol|dl|html)$/i;return function(i){for(var r,o=i[0],n=s.body;(o=o[r?"offsetParent":"parentNode"])&&1==o.nodeType&&o!=n;)r||t.test(o.nodeName)||(r=o),r&&"visible"!=e.css(o,"overflow")&&"static"!=e.css(o,"position")&&(r=!1);return e(r||n)}}(),prepareFor:function(t,i){var s,r,o=this,n={},a=e.extend(!0,{},this.options,t.jProp("form").data("wspopover")||{},t.data("wspopover"));this.lastOpts=a,this.lastElement=e(t).getShadowFocusElement(),this.prepared&&this.options.prepareFor||(r="element"==a.appendTo||a.inline&&"auto"==a.appendTo?i.parent():"auto"==a.appendTo?this._getAutoAppendElement(i):e(a.appendTo),this.prepared&&r[0]==this.element[0].parentNode||this.element.appendTo(r)),this.element.attr({"data-class":t.prop("className"),"data-id":t.prop("id")}),a.constrainWidth?(this.element.addClass("ws-popover-constrained-width"),n.minWidth=i.outerWidth()):(this.element.removeClass("ws-popover-constrained-width"),n.minWidth=""),a.inline?this.element.addClass("ws-popinline ws-po-visible"):this.element.removeClass("ws-popinline"),this.element.css(n),a.hideOnBlur&&(s=function(e){o.stopBlur?e.stopImmediatePropagation():o.hide()},o.timers.bindBlur=setTimeout((function(){o.lastElement.off(o.eventns).on("focusout"+o.eventns+" blur"+o.eventns,s),o.lastElement.getNativeElement().off(o.eventns)}),10)),this.prepared=!0},clear:function(){e(i).off(this.eventns),e(s).off(this.eventns),e(s.body).off(this.eventns).children(":not(script), :not(iframe), :not(noscript)").off(this.eventns),this.element.off("transitionend"+this.eventns),this.stopBlur=!1,this.lastOpts=!1,e.each(this.timers,(function(e,t){clearTimeout(t)}))},hide:function(){var t,s=e.Event("wspopoverbeforehide");if(this.element.trigger(s),!s.isDefaultPrevented()&&this.isVisible){this.isVisible=!1;var r=this,o=function(t){t&&"transitionend"==t.type&&(t=t.originalEvent)&&t.target==r.element[0]&&"hidden"==r.element.css("visibility")||(r.element.off("transitionend"+r.eventns).css("display","none").attr({"data-id":"","data-class":"",hidden:"hidden"}),clearTimeout(r.timers.forcehide),e(i).off("resize"+r.eventns))};this.clear(),this.options.inline?(t=(z[this.options.inline]||z.slide).hide,this.element[t]()):(this.element.removeClass("ws-po-visible"),e(i).on("resize"+this.eventns,o),L&&this.element.off("transitionend"+this.eventns).on("transitionend"+this.eventns,o),r.timers.forcehide=setTimeout(o,L?600:40)),this.element.trigger("wspopoverhide")}},position:function(e){var i;(this.lastOpts||this.options).inline||(i=t.getRelOffset(this.element.removeAttr("hidden"),e,(this.lastOpts||this.options).position),this.element.css(i))}}),t.validityAlert=function(){o.messagePopover.position=e.extend({},{at:"left bottom",my:"left top",collision:"none"},o.messagePopover.position||{});var i=t.objectCreate(t.wsPopover,r,o.messagePopover),s=i.hide.bind(i);return i.element.addClass("validity-alert").attr({role:"alert"}),e.extend(i,{hideDelay:5e3,showFor:function(t,i,r,o){t=e(t).getNativeElement(),this.clear(),this.hide(),o||(this.getMessage(t,i),this.show(t),this.hideDelay&&(this.timers.delayedHide=setTimeout(s,this.hideDelay))),r||this.setFocus(t)},setFocus:function(s){var r=e(s).getShadowFocusElement(),n=t.scrollRoot.scrollTop()+(o.viewportOffset||0),a=r.offset().top-(o.scrollOffset||30),l=function(){try{r[0].focus()}catch(e){}r[0].offsetWidth||r[0].offsetHeight||t.warn("invalid element seems to be hidden. Make element either visible or use disabled/readonly to bar elements from validation. With fieldset[disabled] a group of elements can be ignored! In case of select replacement see shims/form-combat.js to fix issue."),i.element.triggerHandler("pospopover")};n>a?t.scrollRoot.animate({scrollTop:a-5-(o.viewportOffset||0)},{queue:!1,duration:Math.max(Math.min(600,1.5*(n-a)),80),complete:l}):l()},getMessage:function(e,t){t||(t=e.getErrorMessage()),t?i.contentElement.html(t):this.hide()}}),i}(),m.fx&&z[m.fx]||(m.fx="slide"),e.fn[z[m.fx].show]||(m.fx="no");var H=0;t.errorbox={create:function(t,i){i||(i=this.getFieldWrapper(t));var s=e("."+C,i);return s.length||(s=e("<"+E+' class="'+C+'" hidden="hidden" style="display: none;" />'),i.append(s)),s.prop("id")||(H++,s.prop("id","errorbox-"+H)),i.data("errorbox",s),s},getFieldWrapper:function(i){var s;return(s="function"==typeof m.fieldWrapper?m.fieldWrapper.apply(this,arguments):e(i).parent().closest(m.fieldWrapper)).length||t.error("could not find fieldwrapper: "+m.fieldWrapper),s},_createContentMessage:function(){var i=function(){return!i.types[this.type]};i.types={hidden:1,image:1,button:1,reset:1,submit:1};var s={},r=function(e){return"-"+e.toLowerCase()},o=function(t){var i=e(t).data("errortype");return i||e.each(s,(function(s,r){return e.find.matchesSelector(t,r)?(i=s,!1):void 0})),i||"defaultMessage"};return e.each(["customError","badInput","typeMismatch","rangeUnderflow","rangeOverflow","stepMismatch","tooLong","tooShort","patternMismatch","valueMissing"],(function(e,t){var i=t.replace(/[A-Z]/,r);s[t]="."+i+", ."+t+", ."+t.toLowerCase()+', [data-errortype="'+t+'"]'})),function(s,r,n){var a=!1,l={};e(r).children().each((function(){var t=o(this);l[t]=e(this).html()})),e("input, select, textarea",n).filter(i).each((function(i,s){var r=e(s).data("errormessage")||{};"string"==typeof r&&(r={defaultMessage:r}),e.each(l,(function(e,t){r[e]||(a=!0,r[e]=t)})),a&&e(s).data("errormessage",r),t.getOptions&&t.getOptions(s,"errormessage",!1,!0)}))}}(),initIvalContentMessage:function(t){var i;m.sel&&(i=e.prop(t,"form"))&&e.find.matchesSelector(i,m.sel)&&this.get(t)},get:function(t,i){i||(i=this.getFieldWrapper(t));var s,r=i.data("errorbox");return"object"!=(s=typeof r)&&(r?"string"==s&&(r=e("#"+r),i.data("errorbox",r,i)):r=this.create(t,i),this._createContentMessage(t,r,i)),r},addSuccess:function(t,i){var s=e.prop(t,"type"),r=function(){var r=T[s]?e.prop(t,"checked"):e(t).val();i[r?"addClass":"removeClass"](b)},o=O[s]?"change":"blur";e(t).off(".recheckvalid").on(o+".recheckinvalid",r),r()},hideError:function(t,i){var s,r,o,n=this.getFieldWrapper(t);return i||(s=e("input:invalid, select:invalid, textarea:invalid",n)),n.hasClass(w)&&(e(t).filter("input").off(".recheckinvalid"),!i&&s&&s[0]?e(s).trigger("updatevalidation.webshims"):(r=this.get(t,n),n.removeClass(w),r.message="",o=function(){this.id==t.getAttribute("aria-describedby")&&t.removeAttribute("aria-describedby"),e(this).attr({hidden:"hidden"})},"no"!=m.fx?r[z[m.fx].hide](o):r[z[m.fx].hide]().each(o))),i||s&&s.length||this.addSuccess(t,n),n},recheckInvalidInput:function(t){if(m.recheckDelay&&m.recheckDelay>90){var i,s=function(){V({type:"input",target:t})};e(t).filter('input:not([type="checkbox"]):not([type="radio"]), textarea').off(".recheckinvalid").on("input.recheckinvalid",(function(){clearTimeout(i),i=setTimeout(s,m.recheckDelay)})).on("focusout.recheckinvalid",(function(){clearTimeout(i)}))}},showError:function(t){var i=this.getFieldWrapper(t),s=this.get(t,i),r=e(t).getErrorMessage();return s.message!=r&&(s.stop&&s.stop(!0,!0),s.html("<"+k+' class="'+x+'">'+r+"</"+k+">"),s.message=r,i.addClass(w).removeClass(b),this.recheckInvalidInput(t),(s.is("[hidden]")||"none"==s.css("display"))&&(t.getAttribute("aria-describedby")||t.setAttribute("aria-describedby",s.prop("id")),s.css({display:"none"}).removeAttr("hidden")[z[m.fx].show]())),i.removeClass(b),e(t).off(".recheckvalid"),i},reset:function(e){this.hideError(e,!0).removeClass(b)},toggle:function(t){e.find.matchesSelector(t,":invalid")?this.showError(t):this.hideError(t)}},e(s.body).on({changedvaliditystate:function(i){var s;m.sel&&(s=e.prop(i.target,"form"))&&e.find.matchesSelector(s,m.sel)&&t.errorbox.toggle(i.target)},"resetvalidityui.webshims":function(i){var s;m.sel&&(s=e.prop(i.target,"form"))&&e.find.matchesSelector(s,m.sel)&&t.errorbox.reset(i.target)},firstinvalid:function(i){var s;m.sel&&m.handleBubble&&m.sel&&(s=e.prop(i.target,"form"))&&e.find.matchesSelector(s,m.sel)&&(i.preventDefault(),"none"!=m.handleBubble&&t.validityAlert.showFor(i.target,!1,!1,"hide"==m.handleBubble))},submit:function(t){return m.sel&&m.submitCheck&&e.find.matchesSelector(t.target,m.sel)&&e.prop(t.target,"noValidate")&&!e(t.target).checkValidity()?(t.stopImmediatePropagation(),!1):void 0}}),/[\s\:\>\~\+]/.test(m.sel||"")&&t.error("please use a simple selector for iVal.sel: for example .validate"),o.replaceValidationUI&&e(s).on("firstinvalid",(function(e){e.isDefaultPrevented()||(e.preventDefault(),setTimeout((function(){t.validityAlert.showFor(e.target)}),4))})),function(){var t,i,r,o=[];e(s).on("invalid",(function(s){if(!s.wrongWebkitInvalid&&!r){var n=e(s.target);t||e.find.matchesSelector(s.target,"form, fieldset")||(t=e.Event("firstinvalid"),n.addClass("first-invalid").trigger(t)),t&&t.isDefaultPrevented()&&s.preventDefault(),o.push(s.target),s.extraData="fix",clearTimeout(i),i=setTimeout((function(){var i={type:"lastinvalid",cancelable:!1,invalidlist:e(o)};o=[],r=!0,e(s.target).trigger(i,[i]),e(t.target).removeClass("first-invalid"),t=!1,r=!1}),9),n=null}}))}(),e((function(){var e="FileReader"in i&&"FormData"in i;e||t.addReady((function(i){!e&&I["filereader-xhr"]&&!I["filereader-xhr"].loaded&&i.querySelector("input.ws-filereader")&&(t.reTest(["filereader"]),e=!0)}))})),e.swap||(e.swap=function(e,t,i,s){var r,o,n={};for(o in t)n[o]=e.style[o],e.style[o]=t[o];for(o in r=i.apply(e,s||[]),t)e.style[o]=n[o];return r}),t.addReady((function(t,i){e(t.querySelectorAll(".ws-custom-file")).add(e(i).filter(".ws-custom-file")).each(a)})),W("form-fixrangechange",{test:!(!e.event.special.change&&!e.event.special.input&&d.inputtypes.range&&o.fixRangeChange)}),W("form-inputmode",{test:!(!o.noInputmodeFix&&s.addEventListener&&d.inputtypes.number&&-1!=h.indexOf("Mobile")&&(!("inputMode"in s.createElement("input"))||"inputmode"in s.createElement("input")))}),W("form-combat",{d:["dom-support"],test:!(e.mobile&&(e.mobile.selectmenu||e.mobile.checkboxradio)||e.ui&&e.ui.selectmenu||e.fn.select2||e.fn.chosen||e.fn.selectpicker||e.fn.selectBoxIt)}),W("position",{src:"plugins/jquery.ui.position.js",test:!(!e.position||!e.position.getScrollInfo)}),M.loadList(["form-combat","position","form-fixrangechange","form-inputmode"])}));