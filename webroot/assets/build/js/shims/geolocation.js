!function(o){var e=window.webshims;setTimeout((function(){e.isReady("geolocation",!0)}));var t,i,n=function(){setTimeout((function(){throw"document.write is overwritten by geolocation shim. This method is incompatible with this plugin"}),1)},a=0,c=e.cfg.geolocation||{};navigator.geolocation||(navigator.geolocation={}),o.extend(navigator.geolocation,(i={getCurrentPosition:function(i,a,r){var s,l,u,d=2,g=function(){if(!u)if(t){if(u=!0,i(o.extend({timestamp:(new Date).getTime()},t)),f(),window.JSON&&window.sessionStorage)try{sessionStorage.setItem("storedGeolocationData654321",JSON.stringify(t))}catch(o){}}else a&&!d&&(u=!0,f(),a({code:2,message:"POSITION_UNAVAILABLE"}))},m=function(){d--,w(),g()},f=function(){o(document).off("google-loader",f),clearTimeout(l),clearTimeout(s)},w=function(){if(t||!window.google||!google.loader||!google.loader.ClientLocation)return!1;var e=google.loader.ClientLocation;return t={coords:{latitude:e.latitude,longitude:e.longitude,altitude:null,accuracy:43e3,altitudeAccuracy:null,heading:parseInt("NaN",10),velocity:null},address:o.extend({streetNumber:"",street:"",premises:"",county:"",postalCode:""},e.address)},!0};return function(){if(!t&&(w(),!t&&window.JSON&&window.sessionStorage))try{(t=!!(t=sessionStorage.getItem("storedGeolocationData654321"))&&JSON.parse(t)).coords||(t=!1)}catch(o){t=!1}}(),t?void setTimeout(g,1):c.confirmText&&!confirm(c.confirmText.replace("{location}",location.hostname))?void(a&&a({code:1,message:"PERMISSION_DENIED"})):(o.ajax({url:"http://freegeoip.net/json/",dataType:"jsonp",cache:!0,jsonp:"callback",success:function(o){d--,o&&(t=t||{coords:{latitude:o.latitude,longitude:o.longitude,altitude:null,accuracy:43e3,altitudeAccuracy:null,heading:parseInt("NaN",10),velocity:null},address:{city:o.city,country:o.country_name,countryCode:o.country_code,county:"",postalCode:o.zipcode,premises:"",region:o.region_name,street:"",streetNumber:""}},g())},error:function(){d--,g()}}),clearTimeout(l),window.google&&window.google.loader?d--:l=setTimeout((function(){c.destroyWrite&&(document.write=n,document.writeln=n),o(document).one("google-loader",m),e.loader.loadScript("http://www.google.com/jsapi",!1,"google-loader")}),800),void(s=r&&r.timeout?setTimeout((function(){f(),a&&a({code:3,message:"TIMEOUT"})}),r.timeout):setTimeout((function(){d=0,g()}),1e4)))},clearWatch:o.noop,watchPosition:function(o,e,t){return i.getCurrentPosition(o,e,t),++a}},i)),e.isReady("geolocation",!0)}(webshims.$);