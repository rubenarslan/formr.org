webshims.register("jmebase",(function(e,t,n,a,i){"use strict";var r={},o={},d=Array.prototype.slice,s=0,l=e.extend({selector:".mediaplayer"},t.cfg.mediaelement.jme),u=l.selector;t.cfg.mediaelement.jme=l,e.jme||(e.jme={}),e.extend(e.jme,{pluginsClasses:[],pluginsSel:"",plugins:{},props:r,fns:o,data:function(t,n,a){var r=e(t).data("jme")||e.data(t,"jme",{});return a===i?n?r[n]:r:void(r[n]=a)},runPlugin:function(t){s&&e(document.querySelectorAll(u)).each((function(){var n=this.querySelectorAll(t);n.length&&e(this).jmeFn("addControls",n)}))},registerPlugin:function(t,n){this.plugins[t]=n,n.nodeName||(n.nodeName=""),n.className||(n.className=t),this.pluginsClasses.push("."+n.className),this.pluginsSel=this.pluginsClasses.join(", "),l[t]=e.extend(n.options||{},l[t]),l[t]&&l[t].text?n.text=l[t].text:l.i18n&&l.i18n[t]&&(n.text=l.i18n[t]),this.runPlugin("."+n.className)},configmenuPlugins:{},addToConfigmenu:function(e,t){this.configmenuPlugins[e]=t},defineMethod:function(e,t){o[e]=t},defineProp:function(t,n){n||(n={}),n.set||(n.set=n.readonly?function(){throw t+" is readonly"}:e.noop),n.get||(n.get=function(n){return e.jme.data(n,t)}),r[t]=n},prop:function(t,n,a){if(!r[n])return e.prop(t,n,a);if(a===i)return r[n].get(t);var o=r[n].set(t,a);o===i&&(o=a),"noDataSet"!=o&&e.jme.data(t,n,o)}}),e.fn.jmeProp=function(t,n){return e.access(this,e.jme.prop,t,n,arguments.length>1)},e.fn.jmeFn=function(n){var a,r=d.call(arguments,1);return this.each((function(){return e.jme.data(this).media||(e(this).closest(u).jmePlayer(),t.warn("jmeFn called to early or on wrong element!")),(a=(o[n]||e.prop(this,n)).apply(this,r))===i&&void 0})),a!==i?a:this};var p={emptied:1,pause:1},m={canplay:1,canplaythrough:1};e.jme.initJME=function(t,n){s+=e(t.querySelectorAll(u)).add(n.filter(u)).jmePlayer().length},e.jme.getDOMList=function(t){var n=[];return t||(t=[]),"string"==typeof t&&(t=t.split(" ")),e.each(t,(function(e,t){t&&(t=document.getElementById(t))&&n.push(t)})),n},e.jme.getButtonText=function(t,n){var a,i;return t.is('[type="checkbox"], [type="radio"]')?(t.prop("checked",(function(){return this.defaultChecked})),a=!0):t.is("a")&&t.on("click",(function(e){e.preventDefault()})),function(r){i!==r&&(i=r,t.removeClass(n[r?0:1]).addClass(n[r]),a&&(t.prop("checked",!!r),(t.data("checkboxradio")||{refresh:e.noop}).refresh()))}},e.fn.jmePlayer=function(){return this.each((function(){var t,n,a,i,r,o,d=e("audio, video",this).eq(0),s=e(this),l=e.jme.data(this),u=e.jme.data(d[0]);s.addClass(d.prop("nodeName").toLowerCase()+"player"),u.player=s,u.media=d,l.media||(o=function(){s[0].className=s[0].className},a=function(){d.off("canplay",n),clearTimeout(i)},n=function(){var e=d.prop("paused")?"idle":"playing";s.attr("data-state",e)},t=function(t){var l,u,c=t.type;a(),m[c]&&"waiting"!=r||("ended"==c||e.prop(this,"ended")?c="ended":"waiting"==c?e.prop(this,"readyState")>2?c="":(i=setTimeout((function(){d.prop("readyState")>2&&n()}),9),d.on("canPlay",n)):p[c]?c="idle":(l=e.prop(this,"readyState"),c=!(u=e.prop(this,"paused"))&&3>l?"waiting":!u&&l>2?"playing":"idle"),"idle"==c&&s._seekpause&&(c=!1),c&&(r=c,s.attr("data-state",c),setTimeout(o)))},l.media=d,l.player=s,d.on("emptied waiting canplay canplaythrough playing ended pause mediaerror",t).on("volumechange updateJMEState",(function(){var t=e.prop(this,"volume");s[!t||e.prop(this,"muted")?"addClass":"removeClass"]("state-muted"),t=.01>t?"no":.36>t?"low":.7>t?"medium":"high",s.attr("data-volume",t)})),e.jme.pluginsSel&&s.jmeFn("addControls",e(s[0].querySelectorAll(e.jme.pluginsSel))),t&&d.on("updateJMEState",t).triggerHandler("updateJMEState"))}))},e.jme.defineProp("isPlaying",{get:function(t){return!e.prop(t,"ended")&&!e.prop(t,"paused")&&e.prop(t,"readyState")>1&&!e.data(t,"mediaerror")},readonly:!0}),e.jme.defineProp("player",{readonly:!0}),e.jme.defineProp("media",{readonly:!0}),e.jme.defineProp("srces",{get:function(t){var n=e.jme.data(t),a=n.media.prop("src");return a?[{src:a}]:e.map(e("source",n.media).get(),(function(t){var n,a,i={src:e.prop(t,"src")},r=t.attributes;for(n=0,a=r.length;a>n;n++)"specified"in r[n]&&!r[n].specified||(i[r[n].nodeName]=r[n].nodeValue);return i}))},set:function(t,n){var a=e.jme.data(t),i=function(t,n){"string"==typeof n&&(n={src:n}),e(document.createElement("source")).attr(n).appendTo(a.media)};return a.media.removeAttr("src").find("source").remove(),e.isArray(n)?e.each(n,i):i(0,n),a.media.jmeFn("load"),"noDataSet"}}),e.jme.defineMethod("togglePlay",(function(){e(this).jmeFn(r.isPlaying.get(this)?"pause":"play")})),e.jme.defineMethod("addControls",(function(t){var n=e.jme.data(this)||{};if(n.media){var a=e.jme.data(n.player[0],"controlElements")||e([]);t=e(t),e.jme.pluginsSel&&(t=t.find(e.jme.pluginsSel).add(t.filter(e.jme.pluginsSel))),t.length&&(e.each(e.jme.plugins,(function(a,i){var r,o,d,s,l=t.filter("."+i.className);for(d=0;d<l.length;d++)if(r=e(l[d]),(o=e.jme.data(l[d])).player=n.player,o.media=n.media,!o._rendered){if(o._rendered=!0,i.options)for(s in i.options)s in o||(o[s]=i.options[s]);i._create(r,n.media,n.player,o)}})),e.jme.data(n.player[0],"controlElements",a.add(t)),n.player.triggerHandler("controlsadded"))}})),t.ready("DOM mediaelement",(function(){t.isReady("jme",!0),t.addReady(e.jme.initJME),t.isReady("jme-base",!0),!1!==t.cfg.debug&&document.getElementsByTagName("video").length&&!document.querySelector(u)&&t.warn("found video element but video wasn't wrapped inside a ."+u+" element. Will not add control UI")}))}));