webshim.ready("jmebase es5",(function(){function e(e){return e.src||e}function a(a,r){var t=!0;return r&&a.length===r.length?(a=a.map(e),n.each(r,(function(e,r){return-1==a.indexOf(r.src||r)?(t=!1,!1):void 0}))):t=!1,t}function r(e){return'<li role="presentation"><label><input type="radio" name="alternate-'+i+'" value="'+e.group+'" /><span>'+e.label+"</span></label></li>"}var t=window.webshim,n=t.$,o=n.jme;o.defineProp("currentAlternateSrc",{readonly:!0,get:function(e){var a,r,t=o.data(e),i=t.media.jmeFn("getAlternateSrcData"),u=t.media.prop("currentSrc");if(u)n.each(i.groups,(function(e,r){-1!=r.srces.indexOf(u)&&(a=r)}));else for(r in i.groups){a=i[r];break}return a}}),o.defineMethod("getAlternateSrcData",(function(e){var a={groups:{},groupLength:0},r=o.data(this);return e||(e=r.media.jmeProp("srces")),e.forEach((function(e){var r=e["data-alternate"];a.groups[r]||(a.groupLength++,a.groups[r]={group:r,label:r,srces:[]}),(e["data-label"]||e.title)&&(a.groups[r].label=e["data-label"]||e.title),a.groups[r].srces.push(e.src)})),a.srces=e,a})),o.defineMethod("orderAlternateByName",(function(e,a){var r=o.data(this);return a||(a=r.media.jmeProp("srces")),Array.isArray(e)||(e=[e]),e.reverse(),a.sort((function(a,r){return e.indexOf(r["data-alternate"])-e.indexOf(a["data-alternate"])})),r.media.jmeProp("srces",a),a})),o.defineMethod("switchAlternateByName",(function(e,a){var r=o.data(this),t=r.media.prop("paused"),i=r.media.prop("currentTime");n(this).jmeFn("orderAlternateByName",e,a),i>1&&(r.media.play(),r.media.one("loadedmetadata",(function(){t&&r.media.pause(),r.media.prop("currentTime",i)}))),t||r.media.play()}));var i=0;o.addToConfigmenu("alternate-media",(function(e,t,o,u){var d,s,c,l=function(e){var a=n.prop(e.target,"value");a&&c&&c.groups[a]&&(t.jmeFn("switchAlternateByName",a,c.srces),u.hide())},p=function(){var e;d&&(e=t.jmeProp("currentAlternateSrc"))&&e.group&&n('[value="'+e.group+'"]',d).prop("checked",!0)},m=function(t){if(!d||!c||!a(t.srces,c.srces)){c=t,i++;var o=n.map(c.groups,r);d&&d.remove(),(d=n('<div class="media-submenu"><ul>'+o.join("")+"</ul></div>").appendTo(e)).on("change",l)}p()},f=function(){var e=t.jmeFn("getAlternateSrcData");e.groupLength?m(e):d&&(d.remove(),d=null,c=null)};f(),t.on("loadstart emptied",(function(){clearTimeout(s),s=setTimeout(f)})),t.on("loadedmetadata",p)})),t.ready("jme-base",(function(){t.isReady("alternate-media",!0)}))}));